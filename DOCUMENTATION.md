# مستند شرح الحل - تكليف مطور متكامل لشركة ثمانية

## مقدمة

أهلاً فريق ثمانية،

هذا المستند يقدم شرحاً تفصيلياً للحل التقني الذي تم تنفيذه ضمن تكليف وظيفة "مهندس برمجيات". تم إنجاز المشروع بنجاح، وهو الآن يعمل بشكل كامل على الخوادم السحابية. تم بناء المشروع بالكامل من الصفر باستخدام التقنيات المطلوبة في التكليف، مع التركيز على الجودة، الأداء، وقابلية التوسع.

---

## 1. طريقة الحل والمنهجية المتبعة

تم تقسيم المشروع إلى جزأين أساسيين: الواجهة الخلفية (Backend) والواجهة الأمامية (Frontend)، مع فصل تام بينهما لضمان بنية تحتية حديثة وقابلة للتطوير.

### **أ. الواجهة الخلفية (Backend - NestJS)**

-   **إطار العمل:** تم اختيار **NestJS** نظرًا لبنيته القوية والمعيارية (Modular Architecture) ودعمه الممتاز لـ **TypeScript**، مما يضمن كتابة كود نظيف ومنظم وسهل الصيانة.
-   **بنية الكود:** تم تقسيم المنطق إلى وحدات متخصصة (Modules): وحدة للبحث (`SearchModule`)، وحدة للتواصل مع iTunes API (`ItunesModule`)، ووحدة لقاعدة البيانات (`DatabaseModule`). هذا الفصل يضمن سهولة فهم وتطوير كل جزء على حدة.
-   **قاعدة البيانات:** تم استخدام **AWS DynamoDB** (NoSQL) كما هو مقترح، وتم تصميم جدول `Podcasts` لتخزين نتائج البحث بكفاءة، مما يعمل كطبقة تخزين مؤقت (Caching Layer).
-   **التدفق (Workflow):** عند استقبال طلب على نقطة النهاية `GET /search`، يقوم الـ `Controller` باستدعاء الـ `Service` الذي بدوره يقوم بجلب البيانات من iTunes API، ثم يقوم بتخزينها في DynamoDB بشكل غير متزامن (asynchronously) قبل إعادتها للمستخدم، مما يضمن استجابة سريعة.

### **ب. الواجهة الأمامية (Frontend - Next.js)**

-   **إطار العمل:** تم استخدام **Next.js 15 (App Router)** و **React** لبناء واجهة مستخدم تفاعلية وعالية الأداء. تم الاعتماد على Tailwind CSS لتطبيق التصميم المطلوب بدقة وسرعة قياسية.
-   **بنية المكونات (Components):** تم تحليل التصميم المرفق (`page.html`) وتفكيكه إلى مجموعة من المكونات القابلة لإعادة الاستخدام (Reusable Components) مثل `Sidebar`, `Header`, `PodcastCard`, `EpisodeRow` وغيرها، مما يجعل الكود أكثر تنظيمًا وقابلية للتطوير.
-   **دعم اللغة العربية (RTL):** تم بناء الواجهة بالكامل لدعم اللغة العربية والتخطيط من اليمين إلى اليسار (RTL)، بما في ذلك تعديل اتجاه التخطيط (Layout)، النصوص، والأيقونات لتقديم تجربة مستخدم أصيلة.
-   **الحالة (State Management):** تم استخدام React Hooks (`useState`) لإدارة حالة التطبيق بشكل فعال، بما في ذلك حالة التحميل (Loading)، الأخطاء (Errors)، ونتائج البحث.

### **ج. النشر والتشغيل (Deployment)**

-   **الواجهة الخلفية:** تم نشرها على **AWS Elastic Beanstalk**، مع ضبط كامل للبيئة، بما في ذلك متغيرات البيئة (Environment Variables) للتعامل مع المفاتيح السرية، وصلاحيات IAM (IAM Roles) لضمان الوصول الآمن إلى خدمات AWS الأخرى مثل S3 و DynamoDB.
-   **الواجهة الأمامية:** تم نشرها على **Vercel**، وتم ربطها مباشرة بمستودع GitHub لتمكين النشر المستمر (CI/CD) بسهولة.

---

## 2. أهم الصعوبات التي واجهتها وكيفية حلها

واجهت عدة تحديات تقنية معقدة، والتي كانت فرصة لإثبات مهارات البحث والتحليل وحل المشكلات.

-   **تثبيت EB CLI على نظام Windows:** كانت هذه أصعب مرحلة، حيث واجهت سلسلة من الأخطاء المعقدة المتعلقة بإصدارات Python، ومتطلبات `virtualenv`، وأخيرًا خطأ `FileNotFoundException` بسبب اعتمادية غير ضرورية على IIS في أداة EB CLI. تم حل المشكلة بشكل منهجي عبر تجربة عدة حلول، وصولًا إلى الحل النهائي الذي تطلب تفعيل ميزة "IIS Management Console" في نظام Windows لإرضاء الأداة.

-   **إدارة صلاحيات AWS IAM:** بعد النشر الأولي، فشل التطبيق بسبب نقص الصلاحيات. الخطأ `NotAuthorizedError` قادني إلى تحليل المشكلة وتحديد أن المستخدم المخصص (IAM User) كان بحاجة إلى صلاحيات إضافية لخدمات S3 و Elastic Beanstalk بالإضافة إلى DynamoDB. تم حلها عبر إنشاء وتخصيص Policies إضافية.

-   **مشكلة HTTPS و Mixed Content:** بعد نشر الواجهة الأمامية على Vercel (الذي يعمل بـ HTTPS)، رفض المتصفح الاتصال بالواجهة الخلفية (التي كانت تعمل بـ HTTP). هذا قادني إلى سلسلة من الخطوات لتأمين الواجهة الخلفية:
    1.  طلب شهادة SSL من AWS Certificate Manager (ACM).
    2.  مواجهة مشكلة أمنية في حساب AWS الجديد تطلبت فتح تذكرة دعم فني مع أمازون لحلها.
    3.  تكوين الـ Load Balancer في Elastic Beanstalk لإضافة HTTPS Listener باستخدام الشهادة الجديدة.

-   **أخطاء البناء في Next.js 15:** واجهت أخطاء `Type error` أثناء عملية البناء (`npm run build`) تتعلق بكيفية تعامل الإصدار التجريبي من Next.js مع الـ `params` في الصفحات الديناميكية (Dynamic Routes). بعد عدة محاولات، تم حل المشكلة عبر تعديل إعدادات `tsconfig.json` واستخدام `params: any` كحل نهائي ومستقر لهذه النسخة تحديدًا.

---

## 3. اقتراحات وأفكار إضافية

لتحسين هذا المشروع وتطويره إلى مستوى الإنتاج الكامل، أقترح الأفكار التالية:

-   **على مستوى الواجهة الخلفية:**
    -   **Caching:** إضافة طبقة Caching حقيقية باستخدام Redis أو Memcached لتقليل الضغط على iTunes API وتحسين سرعة الاستجابة للبحث المكرر.
    -   **Validation:** استخدام مكتبة مثل Zod لعمل Validation دقيق للبيانات القادمة من iTunes API قبل تخزينها، لضمان سلامة البيانات.
-   **على مستوى الواجهة الأمامية:**
    -   **State Management:** لمشروع أكبر، يمكن استخدام مكتبة متخصصة لإدارة الحالة مثل Zustand أو Redux Toolkit لتسهيل مشاركة الحالة بين المكونات المعقدة.
    -   **Testing:** كتابة اختبارات Unit و Integration للمكونات باستخدام Vitest و React Testing Library لضمان جودة الكود واستقراره على المدى الطويل.
-   **على مستوى البنية التحتية:**
    -   **CI/CD Pipeline للـ Backend:** بناء خط أنابيب نشر مستمر كامل للواجهة الخلفية باستخدام GitHub Actions لنشر التحديثات تلقائيًا على Elastic Beanstalk.

شكرًا لكم على هذه الفرصة. كان هذا التكليف ممتعًا ومليئًا بالتحديات المفيدة.
